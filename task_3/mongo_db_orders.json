[
  // 1. Створіть кілька замовлень з різними наборами товарів, але так щоб один з товарів був у декількох замовленнях
  [
    {
      "_id": {
        "$oid": "65da1a0f8caa7446dde2f041"
      },
      "order_number": 201513,
      "date": "2015-04-14",
      "total_sum": 1923.4,
      "customer": {
        "name": "Andrii",
        "surname": "Rodinov",
        "phones": [
          9876543,
          1234567
        ],
        "address": "PTI, Peremohy 37, Kyiv, UA"
      },
      "payment": {
        "card_owner": "Andrii Rodionov",
        "cardId": 12345678
      },
      "items_id": [
        "65da18948caa7446dde2f032",
        "65da18948caa7446dde2f031"
      ]
    },
    {
      "_id": {
        "$oid": "65da1b998caa7446dde2f046"
      },
      "order_number": 201513,
      "date": "2023-04-14",
      "total_sum": 1923.4,
      "customer": {
        "name": "Nikita",
        "surname": "Ochinskiy",
        "phones": [
          312312412,
          4123213
        ],
        "address": "PTI, Peremohy 37, Odesa, UA"
      },
      "payment": {
        "card_owner": "Nikita Ochinskiy",
        "cardId": {
          "$numberLong": "1234567812398723"
        }
      },
      "items_id": [
        "65da18948caa7446dde2f032",
        "65da18948caa7446dde2f033"
      ]
    },
    {
      "_id": {
        "$oid": "65da1bda8caa7446dde2f048"
      },
      "order_number": 4911134,
      "date": "2012-04-14",
      "total_sum": 1923.4,
      "customer": {
        "name": "Loza",
        "surname": "Bandura",
        "phones": [
          {
            "$numberLong": "98765435334"
          },
          1234567434
        ],
        "address": "PTI, Peremohy 37, Kyiv, UA"
      },
      "payment": {
        "card_owner": "Loza Bandura",
        "cardId": {
          "$numberLong": "12345678123124"
        }
      },
      "items_id": [
        "65da18948caa7446dde2f034",
        "65da18948caa7446dde2f031"
      ]
    },
    {
      "_id": {
        "$oid": "65da1bfa8caa7446dde2f04a"
      },
      "order_number": {
        "$numberLong": "4911134412"
      },
      "date": "2012-09-14",
      "total_sum": 1923.4,
      "customer": {
        "name": "Koza",
        "surname": "Zandura",
        "phones": [
          {
            "$numberLong": "98765435334"
          },
          1234567434
        ],
        "address": "PTI, Asdas 37, Kyiv, UA"
      },
      "payment": {
        "card_owner": "Loza Bsas",
        "cardId": {
          "$numberLong": "12345678123124"
        }
      },
      "items_id": [
        "65da18948caa7446dde2f034",
        "65da18948caa7446dde2f033"
      ]
    }
  ]

  // 2. Виведіть всі замовлення,
  {}


  // 3. Виведіть замовлення з вартістю більше певного значення,
  {
    total_sum: {
      $gte: 1000.0
    }
  }


  // 4. Знайдіть замовлення зроблені одним замовником,
  {
    "customer.surname": "Rodinov",
    "customer.name": "Andrii"
  }


  // 5. Знайдіть всі замовлення з певним товаром (товарами) (шукати можна по ObjectId),
  {
    items_id: '65da18948caa7446dde2f033'
  }

  // 6. Додайте в усі замовлення з певним товаром ще один товар і збільште існуючу вартість замовлення на деяке значення Х,
  [
    {
      $match: {
        items_id: "65da18948caa7446dde2f033"
      }
    },
    {
      $addFields: {
        items_id: {
          $concatArrays: [
            "$items_id",
            [
              "65da18948caa7446dde2f031"
            ]
          ]
        }
      }
    },
    {
      $addFields: {
        total_sum: {
          $add: [
            "$total_sum",
            900
          ]
        }
      }
    }
  ]


  // 7. Виведіть кількість товарів в певному замовленні,
  [
    {
      $match: {
        order_number: 4911134412
      }
    },
    {
      $unwind: {
        path: "$items_id"
      }
    },
    {
      $count: "Amount of items in order"
    }
  ]

  // 8. Виведіть тільки інформацію про кастомера і номери кредитної карт, для замовлень вартість яких перевищує певну суму,
  [
    {
      $match: /**
       * query: The query in MQL.
       */
      {
        total_sum: {
          $gte: 1000
        }
      }
    },
    {
      $group: {
        _id: {
          customer: "$customer",
          cart_id: "$payment.cardId"
        }
      }
    }
  ]

  // 9. Видаліть товар з замовлень, зроблених за певний період дат
  {
    date: {
      $gte: "2012-09-14",
      $lte: "2014-04-13"
    }
  }

  // 10. Перейменуйте у всіх замовлення ім'я (прізвище) замовника

  [
    {
      $addFields: {
        "customer.name": "Misha",
        "customer.surname": "Mezinov",
        "payment.card_owner": "Misha Mezinov"
      }
    }
  ]

  /* 11. Знайдіть замовлення зроблені одним замовником, і виведіть тільки інформацію про кастомера
   та товари у замовлені підставивши замість ObjectId("***") назви товарів та їх вартість
   (аналог join-а між таблицями orders та items).
   */
  [
    {
      $unwind: {
        path: "$items_id"
      }
    },
    {
      $addFields: {
        items_id: {
          $toObjectId: "$items_id"
        }
      }
    },
    {
      $lookup: {
        from: "items",
        localField: "items_id",
        foreignField: "_id",
        as: "item_params"
      }
    },
    {
      $unwind: {
        path: "$item_params"
      }
    },
    {
      $group: {
        _id: {
          customer_name: "$customer.name",
          customer_surname: "$customer.surname",
          product_category: "$item_params.category",
          product_model: "$item_params.model",
          product_price: "$item_params.price"
        }
      }
    }
  ]
]